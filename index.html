<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Download File</title>
<style>
body{
  margin:0;
  background:linear-gradient(135deg,#0E7C86,#38BFB3,#9EE5C4);
  font-family:Arial;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
.box{
  background:#F4F8F8;
  color:#0F2F3A;
  padding:28px;
  border-radius:16px;
  text-align:center;
  max-width:380px;
  width:100%;
  box-shadow:0 0 30px rgba(0,0,0,.6);
}
.btn{
  background:#38BFB3;
  color:#0F2F3A;
  padding:14px;
  border-radius:10px;
  margin-top:16px;
  cursor:pointer;
  font-weight:bold;
}
.btn:hover{opacity:.9}
.timer{font-size:26px;margin-top:16px;display:none;}
.actions{display:none;margin-top:16px;}
.secondary{background:#9EE5C4;}
.small{color:#0F2F3A;}
</style>
</head>

<body>

<div class="box">
<h2>Download File</h2>
<p>Silakan klik tombol di bawah.</p>

<div id="startBtn" class="btn" onclick="start()">MULAI</div>
<div id="timer" class="timer"></div>

<div id="actions" class="actions">
  <div class="btn" onclick="download()">DOWNLOAD FILE</div>
  <div class="btn secondary" onclick="visit()">LIHAT PRODUK REKOMENDASI</div>
</div>

  <div class="small">üë• Pengunjung: <span id="visitCount">0</span> orang</div>
<div class="small">‚¨áÔ∏è Download: <span id="downloadCount">0</span> kali</div>
  
<div class="small">
‚ö†Ô∏è Tips Keamanan:<br>
Kami tidak pernah meminta OTP, PIN, kata sandi, atau kode verifikasi apa pun.<br>
Jangan pernah membagikan data pribadi Anda di situs yang tidak Anda kenal.<br>
Pastikan alamat website sesuai dengan tujuan Anda.
</div>
</div>   <!-- TUTUP BOX -->

<script>
const shopee = "https://s.shopee.co.id/1BFakhu09c";
const file = "https://drive.google.com/uc?export=download&confirm=t&id=1iKVMJEBUYz5OiPNKY8lZ6ipHlHFdFfMG";

function start(){
  document.getElementById("startBtn").style.display="none";
  let t=5;
  const timer=document.getElementById("timer");
  timer.style.display="block";
  timer.innerText="Tunggu "+t+" detik";

  const c=setInterval(()=>{
    t--;
    timer.innerText="Tunggu "+t+" detik";
    if(t<=0){
      clearInterval(c);
      timer.style.display="none";
      document.getElementById("actions").style.display="block";
    }
  },1000);
}

function visit(){
  window.open(shopee,"_blank");
}
function download(){
  countDownloadGlobal();               // ‚¨ÖÔ∏è ganti ke global
  window.open(shopee,"_blank");
  setTimeout(()=>{
     window.location.href = file;
  },1200);
}
</script>

  <script src="https://api.countapi.xyz/hit/linkqita_downloadengine/visits?callback=visits"></script>
<script src="https://api.countapi.xyz/get/linkqita_downloadengine/download?callback=dl"></script>

<script>
function visits(res){
 document.getElementById("visitCount").innerText = res.value;
}
function dl(res){
 document.getElementById("downloadCount").innerText = res.value;
}
function countDownload(){
 fetch("https://api.countapi.xyz/hit/linkqita_downloadengine/download");
}
</script>

<script>
const API = "https://script.google.com/macros/s/AKfycbxokIcAUjpN3RGA4aY1hJ_qlrQk9X0T994eWMAuqzvpXtHEC8bElIID6Jarg82Djq8F/exec";   // dari Apps Script
const PAGE_ID = "download-engine";     // samakan dengan nama repo kamu

// Hitung visit saat halaman dibuka
fetch(`${API}?page=${PAGE_ID}&action=visit`)
  .then(r=>r.json())
  .then(j=>{
    if(j.ok){
      document.getElementById("visitCount").innerText = j.visits;
      document.getElementById("downloadCount").innerText = j.downloads;
    }
  });

// Hitung download saat klik
function countDownloadGlobal(){
  fetch(`${API}?page=${PAGE_ID}&action=download`)
    .then(r=>r.json())
    .then(j=>{
      if(j.ok){
        document.getElementById("downloadCount").innerText = j.downloads;
      }
    });
}
</script>

  
</body>
</html>
